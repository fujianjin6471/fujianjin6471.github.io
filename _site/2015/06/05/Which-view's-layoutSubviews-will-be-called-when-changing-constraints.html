<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Which view's layoutSubviews will be called when changing constraints</title>
  <meta name="description" content="Under Auto Layout, we are told to forget the frame and keep constraints in mind. When we change a constraint and it doesn’t coincide with the frame influence...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="/2015/06/05/which-view's-layoutsubviews-will-be-called-when-changing-constraints.html">
  <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/"></a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Which view's layoutSubviews will be called when changing constraints</h1>
    <p class="post-meta">Jun 5, 2015</p>
  </header>

  <article class="post-content">
    <p>Under <em>Auto Layout</em>, we are told to forget the <strong>frame</strong> and keep <strong>constraints</strong> in mind. When we change a constraint and it doesn’t coincide with the frame influenced by it, the <code class="highlighter-rouge">layoutSubviews</code> will be called. </p>

<p>The documentation of <code class="highlighter-rouge">layoutSubviews</code> says:</p>

<blockquote>
  <p>the default implementation uses any constraints you have set to determine the size and position of any subviews.</p>
</blockquote>

<p>But, which view’s <code class="highlighter-rouge">layoutSubviews</code> will be called? Let’s have a look. (The demo project is <a href="https://github.com/fujianjin6471/DemosForBlog/tree/master/WhichLayoutSubviews">here</a>, it’s necessary because what follows depend on the constraints set in the project)</p>

<p>First view is the root view of viewController, second view is the subview of first view, third view is the subview of second view.</p>

<p>Firstly, change the width constraint of third view:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">thirdWidthConstraint</span><span class="o">.</span><span class="n">constant</span> <span class="o">+=</span> <span class="mi">1</span></code></pre></figure>

<p>In the console, we see</p>

<ul>
  <li><strong>second layoutSubviews</strong></li>
  <li><strong>third layoutSubviews</strong></li>
</ul>

<p>Since this step will change the width of third view, so <code class="highlighter-rouge">layoutSubviews</code> of third view’s super view (second view) will be called. More about this condition later.</p>

<p>Secondly, change the constraint between the bottom of second view and the bottom of third view:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">secondThirdBottomConstraint</span><span class="o">.</span><span class="n">constant</span> <span class="o">+=</span> <span class="mi">1</span></code></pre></figure>

<p>In the console, we see</p>

<ul>
  <li><strong>first layoutSubviews</strong></li>
</ul>

<p>Since this step will only change second view’s height, so only <code class="highlighter-rouge">layoutSubviews</code> of second view’s super view (first view) will be called.</p>

<p>Thirdly, change the constraint between the top of second view and the top of third view:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">secondThirdTopConstraint</span><span class="o">.</span><span class="n">constant</span> <span class="o">+=</span> <span class="mi">1</span></code></pre></figure>

<p>In the console, we see</p>

<ul>
  <li><strong>first layoutSubviews</strong></li>
  <li><strong>second layoutSubviews</strong></li>
</ul>

<p>This time, the height of second view and the relevant position between second and third view have changed, so both first and second view’s <code class="highlighter-rouge">layoutSubviews</code> are called.</p>

<p>Lastly, change the constraint between the left of first view and the left of second view:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">secondLeftConstraint</span><span class="o">.</span><span class="n">constant</span> <span class="o">+=</span> <span class="mi">1</span></code></pre></figure>

<p>In the console, we see</p>

<ul>
  <li><strong>first layoutSubviews</strong></li>
  <li><strong>second layoutSubviews</strong></li>
</ul>

<p>This time, the relevant position between first and second view changes, along with third view’s position in the screen, so both first and second view’s <code class="highlighter-rouge">layoutSubviews</code> are called.</p>

<p>What can we conclude from above? <strong>When we change a constraint, a view’s <code class="highlighter-rouge">layoutSubviews</code> will be called if any of its subview whose frame is influenced by the constraint</strong>.</p>

<p>However, there is still a doubt in the way, which is reflected by the first condition we considered before. When we change the width constraint of the third view, only the the third view’s width is changed, so as we expect, only <code class="highlighter-rouge">layoutSubviews</code> of third view’s super view (second view) will be called. But the third view’s <code class="highlighter-rouge">layoutSubviews</code> is also called! I have done some more experiments, I’m not sure I get the answer, but I make a guess: <strong>When we change a constraint and it influences a  view which doesn’t have any subviews, both the view and its super view’s <code class="highlighter-rouge">layoutSubviews</code> will be called</strong>. If someone knows why, please tell me, thanks in advance.</p>


  </article>

   <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'fujianjin6471'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Contact Information</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <!--<li></li>-->
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
